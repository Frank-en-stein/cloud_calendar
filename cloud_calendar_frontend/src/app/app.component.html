<div (window:resize)="onResize($event)">
    <app-navigation-bar></app-navigation-bar>
    <div class="container container-fluid">
        <div class="row">
            <div class="month-display">
                <a (click)="stepMonth($event, false)"><span class="glyphicon glyphicon-triangle-left month-arrow"></span></a>
                <input id="NoIconDemo" type="text"
                       size="11"
                       (blur)="onNewCalendar($event)"
                       value="{{months_in_year[current_month] + '/' + current_year}}" disabled="true"/>
                <a (click)="stepMonth($event, true)"><span class="glyphicon glyphicon-triangle-right month-arrow"></span></a>
            </div>
        </div>
        <div class="row" *ngIf="(width>768)">
            <div class="seven-cols">
                <div *ngFor="let day of [0,1,2,3,4,5,6]" class="col-12 col-sm-1 day-name alert-success">
                    {{days_in_week[day]}}
                </div>
            </div>
        </div>
        <div class="row">
            <div *ngFor="let week of [0,1,2,3,4]">
                <div class="col-xs-12 col-sm-12 calendar-row seven-cols" id="{{'week'+week}}">
                    <div  *ngFor="let day of [0,1,2,3,4,5,6]">
                        <div *ngIf="(width<=768 && calendar[week][day]!='0')"
                             style="height: 15vh !important;"
                             class="col-xs-2 col-sm-0 day-name alert-success">
                            {{days_in_week[day]}}
                            <br>
                            <h3 class="{{current_date==calendar[week][day] ? 'today-style' : ''}}">
                                <strong>{{(calendar[week][day]=='0' ? '' : calendar[week][day])}}</strong>
                            </h3>
                        </div>
                        <div *ngIf="!(width<=768 && calendar[week][day]=='0')"
                             class="{{'col-xs-10 col-sm-1' +(calendar[week][day]=='0' ? '':' cell')}}">
                            <div class="cell-content" *ngIf="calendar[week][day]!='0'">
                                <div class="cell-header">
                                    <p *ngIf="(calendar[week][day]!='0' && width>768)"
                                       class="{{isToday(calendar[week][day]) ? 'today-style' : ''}}">
                                        {{calendar[week][day]}}
                                    </p>
                                    <div class="event-icons">
                                        <a data-toggle="modal"
                                           data-target="#listModal"
                                           (click)="onListEvent($event)"
                                           *ngIf="events[calendar[week][day]].length > 0"
                                        >
                                            <span id="{{'listevent_'+calendar[week][day]}}"
                                                  class="glyphicon glyphicon-th-list alert-success event-icon"
                                                  style="cursor: pointer"></span>
                                        </a>
                                        &nbsp;
                                        <a data-toggle="modal" data-target="#myModal" (click)="onAddEvent($event)">
                                            <span id="{{'addevent_'+calendar[week][day]}}"
                                                  class="glyphicon glyphicon-plus alert-warning event-icon"
                                                  style="cursor: pointer">
                                            </span>
                                        </a>
                                    </div>
                                </div>
                                <div class="cell-body" *ngIf="events[calendar[week][day]].length > 0">
                                    <p *ngFor="let ev of events[calendar[week][day]]; let id=index"
                                       id="event_{{calendar[week][day]+'_'+id}}"
                                       data-toggle="modal"
                                       data-target="#myModal"
                                       (click)="onEditEvent($event)"
                                       class="alert-info"
                                       style="margin:0 0 0 0; border-bottom: thin solid grey; cursor: pointer" >
                                            {{ev.name}}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--Event Modal -->
            <div class="modal fade" id="myModal" role="dialog">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">
                                Event On ({{event_props.date+" "+months_in_year[current_month]+" "+current_year}})
                            </h4>
                        </div>
                        <div class="modal-body">
                            <div class="input-group">
                                <span class="input-group-addon">Title</span>
                                <input (input)="event_props.name=$event.target.value; saveButtonState=false"
                                       [value]="event_props.name"
                                       id="msg"
                                       type="text"
                                       class="{{saveFlag==true ? 'form-control alert-danger':'form-control'}}"
                                       name="msg"
                                       placeholder="Event Name..."
                                       required>
                            </div>
                            <br>
                            <div class="form-group">
                                <textarea (input)="event_props.description=$event.target.value; saveButtonState=false"
                                          [value]="event_props.description"
                                          class="form-control"
                                          rows="3"
                                          id="comment"
                                          placeholder="Brief description...">
                                </textarea>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger" (click)="onDeleteEvent()"
                                    style="float: left" data-dismiss="modal" [disabled]="event_props.index===-1">
                                Delete
                            </button>
                            <button type="button"
                                    data-dismiss="modal"
                                    class="btn btn-success"
                                    (click)="onSaveEvent()">
                                {{saveButtonState ? "Saved" : "Save"}}
                            </button>
                            <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Modal -->
            <!--List Modal -->
            <div class="modal fade" id="listModal" role="dialog">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">
                                Events On ({{event_props.date+" "+months_in_year[current_month]+" "+current_year}})
                            </h4>
                        </div>
                        <div class="modal-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Details</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr *ngFor="let ev of events[event_props.date]; let id=index"
                                        style="cursor: pointer">
                                        <td id="listedeventname_{{event_props.date+'_'+id}}"
                                            data-dismiss="modal"
                                            data-toggle="modal"
                                            data-target="#myModal"
                                            (click)="onEditEvent($event)">
                                            {{ev.name}}
                                        </td>
                                        <td id="listedeventdescription_{{event_props.date+'_'+id}}"
                                            data-dismiss="modal"
                                            data-toggle="modal"
                                            data-target="#myModal"
                                            (click)="onEditEvent($event)">
                                            {{ev.description}}
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Modal -->
        </div>
    </div>
</div>
